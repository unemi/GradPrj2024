# マルチエージェントシミュレーション
## 個体集団
* 個体の表現＋相互作用＋（環境条件）
* 初期状態、状態遷移規則　各個体：状態→行動→次の状態

## 個体の状態
位置（2次元連続値座標）、自分の見た目（可変）、見た目の好み
	性格（ばらつき）：積極性、寛容性、浮気度、移動力
	パートナー：一人 or いない

## 個体の移動規則
* 引力：好きな個人、面白いイベント、学校・職場への定期的移動
* 斥力：嫌いな人、危険なイベント、

## 個体の求愛行動
* 求愛するかどうか：
見つけた相手の好みの度合い＋積極性（＋パートナーがいる場合は浮気度）
* 求愛を受理するかどうか：
	* 	好み度合い＋寛容性（＋パートナーがいる場合は浮気度）
	* 	自分が求愛している相手なら受け入れる。
	*  	複数から求愛されている場合は？
		* そのなかの最良な相手を受け入れる。
		* 許容範囲の中から先着順。
	* 	自分が他の人に求愛中の場合は？　とりあえず逐次処理、競合は避ける。
		* 処理の個体順序は、ランダムに決める。
	* 現実との差は？
		* 返事の引き伸ばし。曖昧な求愛。曖昧な返事。生活。
* 浮気（パートナーがいるとき）
	* 別の人に声をかけるか？
	* 求愛を受理するか？
* パートナーに対する好みの度合いは実際には変化する。
	* いいことされればアップ。いやなことされればダウン。
	* 性格は多次元。どれかの要素の情報が明かされる。

## 性別
* 色分け
	* HSB, 彩度Sと明度Bは 50-100 の一様乱数。
	* 色相Hの範囲を男女で分ける。男：90-270, 女：0-90, 270-360　案
* 形
	* 簡易版：直方体の上に円筒(男性)または球(女性)
	* 現実性と象徴性のあいだ。
	* 3D CG (blender などを使って形状モデルを作る)
* 遺伝子：自分の色(H,S,B)、好みの色相(Hのみ)
	* 伴性遺伝：性別によって発現する遺伝子が異なる。→ 性的二型の進化に繋がる。
	* 伴性遺伝がない場合は、自分の色と好みの色が同じになるような進化が起きる。
	* 実際は、伴性遺伝する形質としない形質が混在。種分化と性的二型化が同時進行する。

## 分析
* カップル数の推移
* 疑問点
	* 浮気に寛容な社会の方がカップルができやすい？
	* カップルが持続する期間は短くなる？
	* 積極性・寛容性の性差は合理的か？　男の方が積極的であることが期待されている？
	* 性差の起源は、子育ての役割分担にある可能性が高い。
	* ファッションコストの性差は発生するか？
	* 裕福さ： ランナウェイ説、ハンディキャップ理論　遺伝的 vs 文化的
		* ex, 孔雀の羽。目印、生きるには不利。
		* 色の場合：彩度。派手なほど子供ができる数が減るが、異性から分かりやすい。好き嫌いのメリハリが大きい。→ モデル参照
		* 手持ち資源を、飾り／健康に使う比率　→ 飾り＝配偶相手を見つけやすい、健康＝配偶後の子ども数が多い。
	* 種分化の分析：クラスター分析？
		* ホプキンス統計 → [WikiPedia](https://en.wikipedia.org/wiki/Hopkins_statistic)
		* 影響すると考えられるパラメータ
			* 伴性遺伝の有無。
			* 観察距離の長短。ex. 世界のサイズの、15, 12.5, 10, 7.5, 5%
			* 動きやすさ。衝突回避の強さ：弱い方が動きやすく、移動距離を長くできる。
	* 性的二型の分析：男女間の発現遺伝子の間の距離
	* 色相の分布についての分析：角度の統計量→複素数で考える。sin, cos に分離。

##モデル
* 	彩度と好みの一致度の式を考える。
* $h_a, s_a$: 相手の色相と彩度。$H_f$ 好みの色相。
	* 等高線の式 $y=\frac{a}{1-2x}, ~~ -1\leq a\leq 1$
	* → $a = (S_{max} - s_a)/S_{max} \cdot (1-2|h_a - H_f| / H_{max})$
	<br/> $a=1$→ 好き、$a=-1$→嫌い。
* 世代交代のモデル
	* 実行ステップと時間 ex. 1ヶ月１ステップ→ n ステップ/フレーム、60 FPS 
	* 寿命の分布：現代社会→ ex. [厚生労働省死亡数統計](https://www.mhlw.go.jp/toukei/saikin/hw/jinkou/geppo/nengai08/kekka3.html)
	* 子ども数の分布	：→ [令和3年度「出生に関する統計」の概況](https://www.mhlw.go.jp/toukei/saikin/hw/jinkou/tokusyu/syussyo07/dl/gaikyou.pdf)
	* 恋する年齢の分布 性差？　13-16才の間に徐々に恋するようになる。<br>
		(0,0)-(12,0)-(14,1.0)-(30,1.0)-(50,0.4)-(90,0.1) 折れ線で表現。<br>
		あるいは $y=(1-\cos \frac{2\pi a x}{(a-1)x+90})/2, a \simeq 3$
	* 適齢期以外の相手に恋をするか？
	* 人口の調整：受精率を調整する。人口多い→低い率、少ない→高い率<br>
		$P'=\left\{ \begin{array}{ll}0&\mbox{if \(S>S_{\max}\)}\\
		0.8\cdot S/S_{\max}\cdot P &\mbox{otherwise}\end{array}\right.$<br>
		$P'$: 修正後の受精率、$P$: 本来の受精率、$S$: 現在の人口、$S_{\max}$: 目標最大人口
	* 派手　→ コスト　実現方法？

## 描画
* カメラからの距離に応じて精細度を変える。<br>
	ex, 球の多面体での近似：分割数 6〜32、距離 AgentSize*2 〜 WorldSize/2.

## 応用
	ラブコメ